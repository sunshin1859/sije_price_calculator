<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIJE êµ¬ë…ë£Œ ê³„ì‚°ê¸°</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Pretendard Variable', sans-serif;
      max-width: 1400px;
      margin: 20px auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 40px;
      border: 1px solid #ccc;
    }
    .flex-row {
      display: flex;
      gap: 40px;
    }
    .form-section {
      flex: 1;
    }
    .result {
      flex: 2;
      background: #f9f9f9;
      padding: 10px;
      border: 1px solid #ddd;
      overflow-x: auto;
    }
    label { display: block; margin-top: 10px; }
    input[type="text"], input[type="number"], select { width: 100%; padding: 4px; margin-top: 4px; }
    .saved-list { margin-top: 10px; font-size: 0.9em; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
    th { background-color: #f0f0f0; }
    .highlight { background-color: #e3f7d9; font-weight: bold; }
    canvas { margin-top: 20px; }
    .remark-box {
      background: #fffdf0;
      border: 1px dashed #bbb;
      padding: 10px;
      font-size: 0.9em;
      line-height: 1.6em;
    }
    .remark-details {
      margin-top: 8px;
      font-size: 0.85em;
      color: #444;
    }
    .remark-details ul {
      margin-top: 5px;
      padding-left: 18px;
    }
    .remark-details li {
      margin-bottom: 4px;
    }
    .service-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
      font-size: 0.85em;
    }
    .service-table th, .service-table td {
      border: 1px solid #aaa;
      padding: 6px;
      text-align: center;
    }
    .service-table th {
      background-color: #f5f5f5;
    }
    button {
      padding: 8px 16px;
      margin-top: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <div class="flex-row">
    <div class="form-section">
      <h1>SIJE êµ¬ë…ë£Œ ê³„ì‚°ê¸°</h1>
      <label>íšŒì‚¬ëª…
        <input type="text" id="companyName" placeholder="íšŒì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
      </label>
      <label>íšŒì‚¬ êµ¬ë¶„
        <select id="companyType">
          <option value="">ì„ íƒ</option>
          <option value="production">ìƒì‚° ì¤‘ì‹¬</option>
          <option value="sourcing">ì†Œì‹± ì¤‘ì‹¬</option>
          <option value="data">ë°ì´í„° ì¤‘ì‹¬</option>
        </select>
      </label>
      <label>ì¬ë´‰í‹€ ìˆ˜
        <input type="number" id="machines" value="0">
      </label>
      <label>ì‚¬ìš©ì ìˆ˜ (Monolis)
        <input type="number" id="users" value="0">
      </label>
      <button id="simulateBtn">ìƒì„¸ ì‹œë®¬ë ˆì´ì…˜</button>
      <button id="saveBtn">ì‹œë®¬ë ˆì´ì…˜ ì €ì¥</button>

      <div class="saved-list">
        <h4>ğŸ“‚ ì €ì¥ëœ ì‹œë®¬ë ˆì´ì…˜ ë³´ê¸°</h4>
        <ul id="savedSimulations"></ul>
      </div>

      <div class="remark-box">
        <strong>ğŸ“Œ Remark</strong><br>
        ê³„ì‚° ê¸°ì¤€ê³¼ ì ìš© ë¹„ìœ¨ì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.
        <div class="remark-details">
          <ul>
            <li><strong>Acquire</strong>: ì „ì²´ ëŒ€ìƒ(ê¸°ê³„ ìˆ˜ ë˜ëŠ” ì‚¬ìš©ì ìˆ˜)ì˜ <strong>5%</strong>ë§Œ ì ìš©ë©ë‹ˆë‹¤. ë°ëª¨ ë‹¨ê³„ì´ë©°, ì„¤ì¹˜ë¹„ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
            <li><strong>Expand</strong>: ì „ì²´ ëŒ€ìƒì˜ <strong>20%</strong>ê°€ ì ìš©ë©ë‹ˆë‹¤. ì¼ë¶€ ê³µì¥ ë° ì‚¬ìš©ìì— ëŒ€í•´ ì •ì‹ ê³„ì•½ì´ ì‹œì‘ë˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.</li>
            <li><strong>Standardize</strong>: ì „ì²´ ëŒ€ìƒì˜ <strong>70%</strong>ê¹Œì§€ í™•ëŒ€ ì ìš©ë©ë‹ˆë‹¤. ì „ì‚¬ ì‹œìŠ¤í…œ í‘œì¤€í™” ë‹¨ê³„ì…ë‹ˆë‹¤.</li>
            <li><strong>Monolog</strong>: ê¸°ê³„ ìˆ˜ ê¸°ì¤€. 120ëŒ€ë‹¹ êµ¬ë…ë£Œê°€ ì‚°ì •ë©ë‹ˆë‹¤. ìµœì´ˆ ë„ì… ì‹œ ì„¤ì¹˜ë¹„ê°€ ë°œìƒí•©ë‹ˆë‹¤.</li>
            <li><strong>MoAI</strong>: Monolog ê¸°ë°˜ AI ì„œë¹„ìŠ¤ë¡œ, Monolog êµ¬ë…ë£Œì˜ 2ë°°ë¡œ ì±…ì •ë©ë‹ˆë‹¤.</li>
            <li><strong>Monolis</strong>: ì‚¬ìš©ì ìˆ˜ ê¸°ì¤€. 1ì¸ë‹¹ ì›” êµ¬ë…ë£Œê°€ ì ìš©ë©ë‹ˆë‹¤.</li>
          </ul>
          <strong>ğŸ’¡ ì„œë¹„ìŠ¤ ë„ì… ë‹¨ê³„ë³„ êµ¬ì„± (íšŒì‚¬ ìœ í˜•ë³„)</strong>
          <table class="service-table">
            <tr>
              <th>ì—°ë„</th>
              <th>ìƒì‚° ì¤‘ì‹¬</th>
              <th>ì†Œì‹± ì¤‘ì‹¬</th>
              <th>ë°ì´í„° ì¤‘ì‹¬</th>
            </tr>
            <tr>
              <td>1ë…„ì°¨ (Acquire)</td>
              <td>Monolog</td>
              <td>Monolis</td>
              <td>MoAI</td>
            </tr>
            <tr>
              <td>2ë…„ì°¨ (Expand)</td>
              <td>Monolog + MoAI</td>
              <td>Monolog + MoAI + Monolis</td>
              <td>MoAI + Monolis</td>
            </tr>
            <tr>
              <td>3ë…„ì°¨ (Expand)</td>
              <td>Monolog + MoAI + Monolis</td>
              <td>Monolog + MoAI + Monolis</td>
              <td>MoAI + Monolis</td>
            </tr>
            <tr>
              <td>4ë…„ì°¨ (Standardize)</td>
              <td>Monolog + MoAI + Monolis</td>
              <td>Monolog + MoAI + Monolis</td>
              <td>MoAI + Monolis</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="result" id="result"></div>
  </div>

  <div class="result">
    <h2>ë¹„êµ ë¶„ì„</h2>
    <label>ë¹„êµí•  íšŒì‚¬ ì„ íƒ (ë³µìˆ˜ ê°€ëŠ¥)
      <select id="compareSelect" multiple style="height: 100px; width: 100%;"></select>
    </label>
    <button onclick="showComparison()">ë¹„êµ ë¶„ì„ ì‹¤í–‰</button>
    <div id="comparisonResult"></div>
    <canvas id="userChart" width="600" height="300"></canvas>
  </div>

  <script>
    // ì €ì¥ëœ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°
    let savedSimulations = JSON.parse(localStorage.getItem('sijeSimulations')) || [];
    let currentSimulation = null;
    
    // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
    const simulateBtn = document.getElementById("simulateBtn");
    const saveBtn = document.getElementById("saveBtn");
    const savedSimulationsList = document.getElementById("savedSimulations");
    const compareSelect = document.getElementById("compareSelect");
    
    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    simulateBtn.addEventListener("click", simulateDetails);
    saveBtn.addEventListener("click", saveSimulation);
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì‹œë®¬ë ˆì´ì…˜ ëª©ë¡ ì—…ë°ì´íŠ¸
    updateSavedSimulationsList();
    
    // ìƒì„¸ ì‹œë®¬ë ˆì´ì…˜ í•¨ìˆ˜
    function simulateDetails() {
      const companyName = document.getElementById("companyName").value;
      const companyType = document.getElementById("companyType").value;
      const machines = parseInt(document.getElementById("machines").value) || 0;
      const users = parseInt(document.getElementById("users").value) || 0;
      
      if (!companyName || !companyType) {
        alert("íšŒì‚¬ëª…ê³¼ íšŒì‚¬ êµ¬ë¶„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }
      
      // ê³„ì‚° ìˆ˜í–‰
      const result = calculateSubscription(companyType, machines, users);
      currentSimulation = {
        companyName,
        companyType,
        machines,
        users,
        result
      };
      
      // ê²°ê³¼ í‘œì‹œ
      displayResult(result, companyName);
    }
    
    // êµ¬ë…ë£Œ ê³„ì‚° í•¨ìˆ˜
    function calculateSubscription(companyType, machines, users) {
      const MONOLOG_UNIT_PRICE = 1200000; // 120ëŒ€ë‹¹ ì›” êµ¬ë…ë£Œ
      const MONOLIS_PRICE = 50000; // 1ì¸ë‹¹ ì›” êµ¬ë…ë£Œ
      const INSTALLATION_FEE = 5000000; // ì„¤ì¹˜ë¹„
      
      const result = {
        years: []
      };
      
      for (let year = 1; year <= 4; year++) {
        let yearData = {
          year,
          monolog: 0,
          moai: 0,
          monolis: 0,
          installation: 0,
          total: 0
        };
        
        // ì ìš© ë¹„ìœ¨ ê³„ì‚°
        let applyRatio = 0;
        if (year === 1) applyRatio = 0.05; // Acquire (5%)
        else if (year === 2 || year === 3) applyRatio = 0.2; // Expand (20%)
        else if (year === 4) applyRatio = 0.7; // Standardize (70%)
        
        // íšŒì‚¬ ìœ í˜•ë³„ ì„œë¹„ìŠ¤ êµ¬ì„±
        if (companyType === "production") {
          // ìƒì‚° ì¤‘ì‹¬
          if (year === 1) {
            // Monologë§Œ
            yearData.monolog = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            yearData.installation = INSTALLATION_FEE;
          } else if (year === 2) {
            // Monolog + MoAI
            yearData.monolog = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            yearData.moai = yearData.monolog * 2;
          } else if (year >= 3) {
            // Monolog + MoAI + Monolis
            yearData.monolog = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            yearData.moai = yearData.monolog * 2;
            yearData.monolis = Math.ceil(users * applyRatio) * MONOLIS_PRICE;
          }
        } else if (companyType === "sourcing") {
          // ì†Œì‹± ì¤‘ì‹¬
          if (year === 1) {
            // Monolisë§Œ
            yearData.monolis = Math.ceil(users * applyRatio) * MONOLIS_PRICE;
          } else if (year >= 2) {
            // Monolog + MoAI + Monolis
            yearData.monolog = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            if (year === 2) yearData.installation = INSTALLATION_FEE;
            yearData.moai = yearData.monolog * 2;
            yearData.monolis = Math.ceil(users * applyRatio) * MONOLIS_PRICE;
          }
        } else if (companyType === "data") {
          // ë°ì´í„° ì¤‘ì‹¬
          if (year === 1) {
            // MoAIë§Œ (Monolog ê¸°ë°˜)
            const monologBase = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            yearData.moai = monologBase * 2;
            yearData.installation = INSTALLATION_FEE;
          } else if (year >= 2) {
            // MoAI + Monolis
            const monologBase = Math.ceil(machines * applyRatio / 120) * MONOLOG_UNIT_PRICE;
            yearData.moai = monologBase * 2;
            yearData.monolis = Math.ceil(users * applyRatio) * MONOLIS_PRICE;
          }
        }
        
        // ì´ì•¡ ê³„ì‚°
        yearData.total = yearData.monolog + yearData.moai + yearData.monolis + yearData.installation;
        result.years.push(yearData);
      }
      
      return result;
    }
    
    // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
    function displayResult(result, companyName) {
      let html = `<h2>${companyName} ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼</h2>`;
      html += `<table>
        <tr>
          <th>ì—°ë„</th>
          <th>Monolog</th>
          <th>MoAI</th>
          <th>Monolis</th>
          <th>ì„¤ì¹˜ë¹„</th>
          <th class="highlight">ì´ì•¡</th>
        </tr>`;
      
      result.years.forEach(yearData => {
        html += `<tr>
          <td>${yearData.year}ë…„ì°¨</td>
          <td>${formatCurrency(yearData.monolog)}</td>
          <td>${formatCurrency(yearData.moai)}</td>
          <td>${formatCurrency(yearData.monolis)}</td>
          <td>${formatCurrency(yearData.installation)}</td>
          <td class="highlight">${formatCurrency(yearData.total)}</td>
        </tr>`;
      });
      
      html += `</table>`;
      document.getElementById("result").innerHTML = html;
    }
    
    // í†µí™” í˜•ì‹ìœ¼ë¡œ ë³€í™˜
    function formatCurrency(amount) {
      return amount ? amount.toLocaleString('ko-KR') + 'ì›' : '-';
    }
    
    // ì‹œë®¬ë ˆì´ì…˜ ì €ì¥ í•¨ìˆ˜
    function saveSimulation() {
      if (!currentSimulation) {
        alert("ë¨¼ì € ì‹œë®¬ë ˆì´ì…˜ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.");
        return;
      }
      
      // ì¤‘ë³µ í™•ì¸
      const exists = savedSimulations.some(sim => 
        sim.companyName === currentSimulation.companyName && 
        sim.companyType === currentSimulation.companyType
      );
      
      if (exists) {
        alert("ì´ë¯¸ ë™ì¼í•œ íšŒì‚¬ëª…ê³¼ ìœ í˜•ì˜ ì‹œë®¬ë ˆì´ì…˜ì´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.");
        return;
      }
      
      savedSimulations.push(currentSimulation);
      localStorage.setItem('sijeSimulations', JSON.stringify(savedSimulations));
      updateSavedSimulationsList();
      updateCompareSelect();
      alert("ì‹œë®¬ë ˆì´ì…˜ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
    
    // ì €ì¥ëœ ì‹œë®¬ë ˆì´ì…˜ ëª©ë¡ ì—…ë°ì´íŠ¸
    function updateSavedSimulationsList() {
      savedSimulationsList.innerHTML = '';
      
      if (savedSimulations.length === 0) {
        savedSimulationsList.innerHTML = '<li>ì €ì¥ëœ ì‹œë®¬ë ˆì´ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
        return;
      }
      
      savedSimulations.forEach((sim, index) => {
        const li = document.createElement('li');
        li.innerHTML = `<strong>${sim.companyName}</strong> (${getCompanyTypeName(sim.companyType)}) 
          - ê¸°ê³„: ${sim.machines}ëŒ€, ì‚¬ìš©ì: ${sim.users}ëª… 
          <button onclick="loadSimulation(${index})">ë³´ê¸°</button>
          <button onclick="deleteSimulation(${index})">ì‚­ì œ</button>`;
        savedSimulationsList.appendChild(li);
      });
    }
    
    // ë¹„êµ ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
    function updateCompareSelect() {
      compareSelect.innerHTML = '';
      
      savedSimulations.forEach((sim, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${sim.companyName} (${getCompanyTypeName(sim.companyType)})`;
        compareSelect.appendChild(option);
      });
    }
    
    // íšŒì‚¬ ìœ í˜• ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
    function getCompanyTypeName(type) {
      switch(type) {
        case 'production': return 'ìƒì‚° ì¤‘ì‹¬';
        case 'sourcing': return 'ì†Œì‹± ì¤‘ì‹¬';
        case 'data': return 'ë°ì´í„° ì¤‘ì‹¬';
        default: return type;
      }
    }
    
    // ì‹œë®¬ë ˆì´ì…˜ ë¡œë“œ
    function loadSimulation(index) {
      if (index >= 0 && index < savedSimulations.length) {
        currentSimulation = savedSimulations[index];
        document.getElementById("companyName").value = currentSimulation.companyName;
        document.getElementById("companyType").value = currentSimulation.companyType;
        document.getElementById("machines").value = currentSimulation.machines;
        document.getElementById("users").value = currentSimulation.users;
        displayResult(currentSimulation.result, currentSimulation.companyName);
      }
    }
    
    // ì‹œë®¬ë ˆì´ì…˜ ì‚­ì œ
    function deleteSimulation(index) {
      if (confirm("ì •ë§ ì´ ì‹œë®¬ë ˆì´ì…˜ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        savedSimulations.splice(index, 1);
        localStorage.setItem('sijeSimulations', JSON.stringify(savedSimulations));
        updateSavedSimulationsList();
        updateCompareSelect();
      }
    }
    
    // ë¹„êµ ë¶„ì„ ì‹¤í–‰
    function showComparison() {
      const selectedIndices = Array.from(compareSelect.selectedOptions).map(opt => parseInt(opt.value));
      
      if (selectedIndices.length < 2) {
        alert("ë¹„êµë¥¼ ìœ„í•´ ìµœì†Œ 2ê°œ ì´ìƒì˜ ì‹œë®¬ë ˆì´ì…˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
      }
      
      const selectedSimulations = selectedIndices.map(index => savedSimulations[index]);
      displayComparison(selectedSimulations);
    }
    
    // ë¹„êµ ê²°ê³¼ í‘œì‹œ
    function displayComparison(simulations) {
      let html = `<h3>ë¹„êµ ë¶„ì„ ê²°ê³¼</h3><table><tr><th>íšŒì‚¬ëª…</th>`;
      
      // í…Œì´ë¸” í—¤ë” ìƒì„± (ì—°ë„ë³„)
      for (let year = 1; year <= 4; year++) {
        html += `<th>${year}ë…„ì°¨ ì´ì•¡</th>`;
      }
      html += `</tr>`;
      
      // ê° ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° í–‰ ì¶”ê°€
      simulations.forEach(sim => {
        html += `<tr><td>${sim.companyName}</td>`;
        sim.result.years.forEach(yearData => {
          html += `<td>${formatCurrency(yearData.total)}</td>`;
        });
        html += `</tr>`;
      });
      
      html += `</table>`;
      document.getElementById("comparisonResult").innerHTML = html;
      
      // ì°¨íŠ¸ ìƒì„±
      createComparisonChart(simulations);
    }
    
    // ë¹„êµ ì°¨íŠ¸ ìƒì„±
    function createComparisonChart(simulations) {
      const ctx = document.getElementById('userChart').getContext('2d');
      
      // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
      if (window.comparisonChart) {
        window.comparisonChart.destroy();
      }
      
      const labels = simulations.map(sim => sim.companyName);
      const datasets = [];
      
      // ì—°ë„ë³„ ë°ì´í„°ì…‹ ìƒì„±
      for (let year = 1; year <= 4; year++) {
        datasets.push({
          label: `${year}ë…„ì°¨`,
          data: simulations.map(sim => sim.result.years[year-1].total),
          backgroundColor: getRandomColor(),
          borderColor: getRandomColor(),
          borderWidth: 1
        });
      }
      
      window.comparisonChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: datasets
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'êµ¬ë…ë£Œ (ì›)'
              }
            },
            x: {
              title: {
                display: true,
                text: 'íšŒì‚¬ëª…'
              }
            }
          }
        }
      });
    }
    
    // ëœë¤ ìƒ‰ìƒ ìƒì„±
    function getRandomColor() {
      const letters = '0123456789ABCDEF';
      let color = '#';
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }
  </script>
</body>
</html>
